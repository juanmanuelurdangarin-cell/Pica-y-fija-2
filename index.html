<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pica y Fija</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    overflow: hidden;
}

.screen {
    width: 100vw;
    height: 100vh;
    position: absolute;
    transition: transform 0.4s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    box-sizing: border-box;
    color: white;
}

#menuScreen {
    background: linear-gradient(135deg, #ff9966, #ff5e62);
    justify-content: center;
}

#screen1 {
    background: linear-gradient(135deg, #ff512f, #dd2476);
    transform: translateX(100%);
}

#screen2 {
    background: linear-gradient(135deg, #8e2de2, #ff6a00);
    transform: translateX(200%);
}

h2 {
    margin: 10px 0;
}

input {
    padding: 10px;
    font-size: 18px;
    text-align: center;
    width: 140px;
    margin: 5px;
    border-radius: 8px;
    border: none;
}

button {
    padding: 12px 20px;
    margin: 8px;
    border: none;
    border-radius: 10px;
    background: #ffd700;
    font-weight: bold;
    font-size: 16px;
}

.bottom-button {
    position: absolute;
    bottom: 20px;
}

.left-bottom {
    position: absolute;
    bottom: 20px;
    left: 20px;
}

.right-top {
    position: absolute;
    top: 15px;
    right: 15px;
}

#history1, #history2 {
    width: 90%;
    max-height: 200px;
    overflow-y: auto;
    margin-top: 10px;
    background: rgba(0,0,0,0.2);
    padding: 10px;
    border-radius: 10px;
}

.history-item {
    margin-bottom: 5px;
}

#victoryScreen {
    position: fixed;
    width: 100vw;
    height: 100vh;
    background: radial-gradient(circle, #ffdd00, #ff5e62);
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    color: white;
    text-align: center;
}
</style>
</head>

<body>

<!-- MENÃš -->
<div id="menuScreen" class="screen">
    <h2>ElegÃ­ tu nÃºmero</h2>
    <input id="menuNumber" maxlength="4" placeholder="0000">
    <button class="bottom-button" onclick="startGame()">ACEPTAR</button>
</div>

<!-- PANTALLA 1 -->
<div id="screen1" class="screen">
    <button class="right-top" onclick="goToScreen2()">âž¡</button>
    <h2>Tu nÃºmero: <span id="displayNumber1">****</span></h2>
    <button onclick="toggleNumber()">Mostrar / Ocultar</button>

    <h3>Intento al rival</h3>
    <input id="guess1" maxlength="4" placeholder="0000">
    <input id="fijas1" placeholder="F">
    <input id="picas1" placeholder="P">
    <button onclick="addManualHistory()">Guardar</button>

    <div id="history1"></div>
</div>

<!-- PANTALLA 2 -->
<div id="screen2" class="screen">
    <button class="right-top" onclick="goToScreen1()">â¬…</button>
    <button class="left-bottom" onclick="finishGame()">Finalizar Juego</button>

    <h2>Tu nÃºmero: <span id="displayNumber2">****</span></h2>
    <button onclick="toggleNumber()">Mostrar / Ocultar</button>

    <h3>NÃºmero del rival</h3>
    <input id="guess2" maxlength="4" placeholder="0000" onkeydown="handleEnter(event)">

    <div id="history2"></div>
</div>

<!-- VICTORIA -->
<div id="victoryScreen">
    <h1>ðŸŽ‰ Â¡FELICITACIONES! ðŸŽ‰</h1>
    <h2>Â¡Adivinaste el nÃºmero!</h2>
    <button onclick="resetGame()">Volver al menÃº</button>
</div>

<script>

let myNumber = "";
let visible = false;
let gameActive = false;

function startGame() {
    let num = document.getElementById("menuNumber").value;

    if (num.length !== 4 || isNaN(num)) {
        alert("Debe ser un nÃºmero de 4 cifras");
        return;
    }

    myNumber = num;
    gameActive = true;

    document.getElementById("menuScreen").style.transform = "translateX(-100%)";
    document.getElementById("screen1").style.transform = "translateX(0)";
    document.getElementById("screen2").style.transform = "translateX(100%)";

    updateDisplay();
}

function toggleNumber() {
    visible = !visible;
    updateDisplay();
}

function updateDisplay() {
    let value = visible ? myNumber : "****";
    document.getElementById("displayNumber1").innerText = value;
    document.getElementById("displayNumber2").innerText = value;
}

function goToScreen2() {
    document.getElementById("screen1").style.transform = "translateX(-100%)";
    document.getElementById("screen2").style.transform = "translateX(0)";
}

function goToScreen1() {
    document.getElementById("screen1").style.transform = "translateX(0)";
    document.getElementById("screen2").style.transform = "translateX(100%)";
}

function addManualHistory() {
    let guess = document.getElementById("guess1").value;
    let f = document.getElementById("fijas1").value;
    let p = document.getElementById("picas1").value;

    if (guess.length !== 4) return;

    let div = document.createElement("div");
    div.className = "history-item";
    div.innerText = guess + " â†’ F: " + f + " | P: " + p;

    document.getElementById("history1").appendChild(div);

    document.getElementById("guess1").value = "";
    document.getElementById("fijas1").value = "";
    document.getElementById("picas1").value = "";
}

function handleEnter(e) {
    if (e.key === "Enter") {
        calculate();
    }
}

function calculate() {
    let guess = document.getElementById("guess2").value;
    if (guess.length !== 4) return;

    let fijas = 0;
    let picas = 0;

    let usedMy = [false,false,false,false];
    let usedGuess = [false,false,false,false];

    for (let i = 0; i < 4; i++) {
        if (guess[i] === myNumber[i]) {
            fijas++;
            usedMy[i] = true;
            usedGuess[i] = true;
        }
    }

    for (let i = 0; i < 4; i++) {
        if (usedGuess[i]) continue;
        for (let j = 0; j < 4; j++) {
            if (!usedMy[j] && guess[i] === myNumber[j]) {
                picas++;
                usedMy[j] = true;
                break;
            }
        }
    }

    let div = document.createElement("div");
    div.className = "history-item";
    div.innerText = guess + " â†’ F: " + fijas + " | P: " + picas;
    document.getElementById("history2").appendChild(div);

    document.getElementById("guess2").value = "";

    if (fijas === 4) {
        showVictory();
    }
}

function showVictory() {
    document.getElementById("victoryScreen").style.display = "flex";
}

function finishGame() {
    resetGame();
}

function resetGame() {
    myNumber = "";
    visible = false;
    gameActive = false;

    document.getElementById("menuNumber").value = "";
    document.getElementById("history1").innerHTML = "";
    document.getElementById("history2").innerHTML = "";
    document.getElementById("victoryScreen").style.display = "none";

    document.getElementById("menuScreen").style.transform = "translateX(0)";
    document.getElementById("screen1").style.transform = "translateX(100%)";
    document.getElementById("screen2").style.transform = "translateX(200%)";
}

</script>

</body>
</html>
